---
title: 'Data 413: Test 1'
author: "Frankie Tyndall"
date: '2022-07-14'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(tidycensus)
library(rvest)
library(ggplot2)
library(textdata)
library(tidytext)
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
```

## 1a: Is U an atomic vector or a list ?

```{r}
U <- c("Maine", "Texas", "Delaware", "Oregon", "Utah", "Vermont", "Ohio")
U
```
All objects of U are character strings so U is an atomic vector


## 1b: Use and show R code that will extract the elements  “Maine” and “Vermont”

```{r}

U[c(1,6)]

```
## 1C: Use and show R code that will extract all elements except “Texas”

```{r}

U[-2]

```

## 1D: Use and show R code that will produce length of U

```{r}

length(U)


```
## 2A:  Is V an atomic vector or a list ?

```{r}

V = list("Chicago", k = list(2, 6, 18, 24), FALSE, 13, 1.3,  y = 1:10)
V


```
V is a list because all the objects in V are not of the same type. List V
has a character string, integers, doubles, and a logical entry.

## 2B: Use and show R code that will extract the 5th element of V

```{r}

V[[5]]

```
## 2C: If the vector V is a list, use and show R code to identify the type of each object in V.

```{r}

str(V)

```
## The Testscore Tibble

```{r}
tribble( ~John,    ~Raymond,    ~Martha,  ~Alice,  ~Juan,     
              86,    77,            81,     88,      90,
              79,    78,            85,     81,      78,   
              76,    75,            88,     94,      81,  
              84,    90,            71,     84,      89,               
              100,   80,            93,     85,      84, 
              90,    73,            70,     88,      93,
         
         ) -> TestScores

TestScores

```
## 3a: Use and show R code (a map function) to find the median for each column.

```{r}

map_dbl(TestScores, median)

```
## 3b: Use and show R code (a map function) to find the cube root of each column element

```{r}

TestScores %>% 
  map(~. ^(0.33333333333))

```
## 3c: Use and show R code (a map function) to convert each column value to 0

```{r}

convert_zero <- TestScores %>% 
  map(~. ^(0)) %>%
  replace(1:5, 0)

convert_zero




```
## 4 Use and show R code, as demonstrated in class to produce the following matrix


```{r}

A <- matrix(c(- 4, -9, -16, -25,
              - 9, -16, -25, -36,
              - 16, -25, -36, -49), ncol = 4, byrow = TRUE)
A



```
## 5A: Show and use a census API key that gives you access to the ACS data. Do not use my API key, use and show your own key.

```{r}

census_api_key("2398180071d436d7b99c3fed84a8602682576343")
install = TRUE

v15 <- load_variables(2015, "acs5", cache = TRUE)
view(v15)



```
## 5B: Using ACS census data from 2015, show and use R code to do the following to produce a tibble that shows the median income estimates and the margin of errors for white males ages    35 - 44 in the counties of California.  The required variable code starts with the characters BO1OO1. Use the table to find the other characters.

```{r}
Cal <- get_acs(geography = "county",
               variables = c(medincome = "B01001A_011"),
               state = " California",
               year = 2015)

Cal



```
## 5c: Use  dplyr functions to change your table of part a so that it reflects estimates that are greater than $30,000 dollars and list the estimates in descending order.

```{r}

estimate_greater <- Cal %>% 
  arrange(desc(estimate)) %>%
  filter(estimate > 30000)

estimate_greater
  





```

## 5D:  Use and show ggplot R coding to produce a scatter plot that features x = natural log of moe plotted against   y = natural log of estimate.  Does your plot suggest a linear relationship between the varibles ?  If so, what general trend can be inferred?  (Use the full data table that you generated for part b)

```{r}

regression <- Cal

regression['X'] <- NULL
regression['Y'] <- NULL

regression['X'] <- log(regression$moe)
regression['Y'] <- log(regression$estimate)

ggplot(regression, aes(x=X, y=Y)) + geom_point()






  





```
The scatterpplot shows that there is a linear correlation between the X and Y variable. The trend has a strong positive linear relationship as the points
form a straight line.

## Use and show R code that will produce the following graph for the data generated in part c

```{r}

estimate_greater <- Cal %>% 
  arrange(desc(estimate)) %>%
  filter(estimate > 30000)

estimate_greater
  

estimate_greater %>%
  mutate(NAME = gsub(" County, California", "", NAME)) %>%
  ggplot(aes(x = estimate, y = reorder(NAME, estimate))) +
  geom_errorbarh(aes(xmin = estimate - moe, xmax = estimate + moe)) +
  geom_point(color = "blue", size = 3) +
  labs(title = "Median Income for White Males by County",
       subtitle = "2014-2018 American Community Survey",
       y = "",
       x = "ACS estimate (bars represent margin of error)")




```

## Provided below is the famous poem,“ Stopping by the Wood On a Snowy Evening”  by Robert Frost.

```{r}
text56 <- c("Whose woods these are I think I know.",
"His house is in the village though",
"He will not see me stopping here",
"To watch his woods fill up with snow.",
"My little horse must think it queer",
"To stop without a farmhouse near",
"Between the woods and frozen lake",
"The darkest evening of the year.",
"He gives his harness bells a shake",
"To ask if there is some mistake.",
"The only other sound’s the sweep",
"Of easy wind and downy flake.",
"The woods are lovely, dark and deep,",
"But I have promises to keep,",
"And miles to go before I sleep",
"And miles to go before I sleep"
)
text56
```

## 6A: Create a tibble
```{r}
text56_tibble <- tibble(line = 241:256, text56 = text56)
text56_tibble

```

## 6B: find line locations of words

```{r}

text56_tibble %>% unnest_tokens(word, text56) -> tibble11
tibble11


```
## 6C: produce a word frequency table

```{r}

tibble11%>%
  count(word, sort =TRUE)




```

## 6d: Create a bar graph data visualization plot that will also display word frequency trends.

```{r}

tibble11%>%
  count(word, sort =TRUE) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(n, word)) +
  geom_col(fill = "blue", color = "red") +
  labs(y = NULL)

```
## 7:  Now using the same body of text found in Problem 6, use and show R code to create a word cloud.  You can use the coding and methods that were illustrated in class or you can use alternate coding of your choice to create the word cloud.

```{r}
text76 <- readLines(file.choose("evening"))
text76
docs4 <- Corpus(VectorSource(text76))


inspect(docs4)
```

```{r}
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
docs4 <- tm_map(docs4, toSpace, "/")
docs4 <- tm_map(docs4, toSpace, "@")
docs4 <- tm_map(docs4, toSpace, "\\|")
docs4 <- tm_map(docs4, content_transformer(tolower))
# Remove numbers
docs4 <- tm_map(docs4, removeNumbers)
# Remove english common stopwords
docs4 <- tm_map(docs4, removeWords, stopwords("english"))
# Remove your own stop word
# specify your stopwords as a character vector
docs4 <- tm_map(docs4, removeWords, c("blabla1", "blabla2"))
# Remove punctuations
docs4 <- tm_map(docs4, removePunctuation)
# Eliminate extra white spaces
docs4 <- tm_map(docs4, stripWhitespace)


dtm <- TermDocumentMatrix(docs4)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)

set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
          max.words=200, random.order=FALSE, rot.per=0.35,
          colors=brewer.pal(8, "PuBuGn"))


```
## 8 Go to the link  https://www.imdb.com/list/ls096735829 and use Selector Gadget ,as demonstrated in class to collect data specific to the movie names, the directors of the movies, the movie ratings, and the running times of the movies.  Your code should produce the final resulting table given below.Hint: (you may have to first create a data frame, and then convert the data frame to the tibble shown below.


```{r}
Link <- "https://www.imdb.com/list/ls096735829"
page = read_html(Link)
Movies2020 = page%>% html_nodes(".lister-item-header a")%>%
  html_text()
Movies2020


Link <- "https://www.imdb.com/list/ls096735829"
page = read_html(Link)
Directors2020 = page%>% html_nodes(".text-muted a:nth-child(1)")%>%
  html_text()
Directors2020


Link <- "https://www.imdb.com/list/ls096735829"
page = read_html(Link)
Ratings2020 = page%>% html_nodes(".ipl-rating-star.small .ipl-rating-star__rating")%>%
  html_text()
Ratings2020

Link <- "https://www.imdb.com/list/ls096735829"
page = read_html(Link)
Runtime2020 = page%>% html_nodes(".runtime")%>%
  html_text()
Runtime2020

moviesdataframe = data.frame(Movies2020,Directors2020, Ratings2020,Runtime2020)

as_tibble(moviesdataframe)

```
