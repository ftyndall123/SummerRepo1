---
title: 'Stat 415 Regression: Homework 2 (Multiple Regression)'
author: "Frankie Tyndall"
date: '2022-07-24'
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Gas Mileage Study

A researcher is interested in developing a model that describes the gas mileage, measured in miles per gallon (mpg), of automobiles.  Based on input from an engineer, she decides that the explanatory variables might be engine size (liters), curb weight (pounds) and horsepower.From a random sample of 13 
automobiles, she obtains the following data.

explanatory variables: engine size, curb weight, horsepower
response variable: gas mileage (MilesperGallon)

## Gas Mileage Dataset
```{r}
tribble(~EngineSize,  ~CurbWeight,  ~Horsepower,  ~MilesperGallon,
                       2.4,         3289,                          177,               24,
                          2.4,         3263,                          158,               25,
                          2.5,         3230,                          170,               24,
                          3.5,         3580,                          272,               22,
                          2.8,         3175,                          255,               18,
                          3.5,         3643,                          263,               22,
                          3.5,         3497,                          306,               20,
                          3.0,         3340,                          230,               21,
                          3.6,         3861,                          263,               19,
                          2.4,         3287,                          173,               24,
                          3.3,         3629,                          234,               21,
                          2.5,         3270,                          170,               22,
                          3.5,         3292,                          270,               22
) -> V
   V
```

## Use and show R code that will produce a correlation matrix.

```{r}
cor(V)
```
## Indicate if the correlation matrix shows multicollinearity problems with pairs of explanatory variables.  The variable Miles per Gallon is the response variable

Using the correlation matrix multicollinearity is definitely found between pairs
of the explanatory variables. The pair horsepower and engine size has a high
correlation of 0.9204991. Engine size and Curb weight also have a relatively
strong correlation. These may indicate that some of the predictor variables
are not needed in the model.

## Indicate the explanatory variable(s) that the response variable is strongly correlated with.

All of the explanatory variables have a negative correlation with the response
variable. Horsepower has the strongest correlation with the reponse variable with a correlation coefficient of -0.7349600.

## Use and show R code that will produce a full multiple regression model, that uses all explanatory variables. Write the full model that shows the coefficients for all explanatory variables and the intercept.

```{r}
V_model <- lm(MilesperGallon~EngineSize + CurbWeight + Horsepower, V)
V_model
```
The Full Model: 


MilesPerGallon = 35.826758 + 4.803063*EngineSize - 0.003945*CurbWeight 
                 - 0.065831*Horsepower
                 

## Use and show R code that will produce all important summary statistics for your model.

```{r}
V_model <- lm(MilesperGallon~EngineSize + CurbWeight + Horsepower, V)
summary(V_model)
```
## Which explanatory variable(s) is/are significant at the level of .05?

Horsepower is the only explanatory variable with a p value less than 0.05
with a p value of 0.03401. Horsepower is the only explanatory variable that is 
significant in the model.

## Use your book or an internet source and describe the difference between R2 and adjusted R2.  (Three or four sentence)

The difference between R^2 and adjusted R^2 is that takes into account all
explanatory variables, whereas the adjusted R squared only factors in explanatory
variables that truly have an impact on the model's performance. Both are ways to
study the proportion of variability in the response variable explained by
the explanatory variable/s but adjust R squared only takes into account the
variables that make an impact on the model to best explain the variation in the
response variable. By taking into account the impact of additional independent factors that have a tendency to skew the outcomes of R-squared measurements, adjusted R-squared increases precision and dependability.

## What is the proportion of the variability in Milespergallon that is explained by the full model regression equation?

The multiple R-squared: 0.6257

62.57% of the variation in Milespergallon is explained by the full model
regression equation.

## What is the proportion of the variability in Milespergallon that is explained by the full model regression equation, only using explanatory variables that have significant impact on the dependent variable.

The Adjusted R-squared:  0.5009 

50.09% of the variablity in  Milespergallon is explained by the full model
regression equation, only using predictor variables that have significant
impact on the dependent variable.

## Use and show R code that produces a model without the explanatory variable with the highest p value. Write the new model that indicates the response variable, the explanatory coefficients and the intercept.

```{r}
removed_V_model <- lm(MilesperGallon~EngineSize + Horsepower, V)
summary(removed_V_model)
```
## Explain why the null hypothesis that the population coefficient for Engine Size is equal to zero is not to be rejected.

The response variable, Engine Size, has a p value of 0.3410 in the model with
the highest p value response variable removed. This p value is larger than
the threshold value of 0.05 which means that it is not significant so you would
not reject that the population coefficient is equal to zero. 

## Which model, the one with three explanatory variables or the one with two explanatory variables is the better model for predicting Miles per gallon?  Justify your answer in three of four sentences.

The model with three explanatory variables seem to be the better fit than the
model with just two variables. Firstly, the model with three explanatory variables have a multiple R-squared of 0.6257 and an adjusted R-squared of  0.5009, the model with only two have smaller multiple R squared and adjusted
R-squared. The model with three have higher R-squared values which is an indicator a better model. In the model with three, the p values of the predictor
variable were smaller, this also indicates that it was the better model. 

